# HTTP API 설계 예시

POST, PUT 둘다 데이터를 저장할 때 쓸 수 있는데 둘이 다른 점은 뭘까?

## 회원 관리 시스템을 만든다고 가정해보자

### API 설계 - POST 기반 등록


URI 리소스를 식별하는 것은 리소스가 아닌 다른 것을 식별하면 안된다. 오로지 리소스만!!

/members 를 컬렉션이라고 한다.

PUT, PATCH

PUT을 쓰는 경우 - 게시글을 수정할 때!

주로 PATCH를 사용한다. 이유는 PUT으로 수정할 때 데이터 전체를 보내야하기 때문에

**POST를 통해 리소스를 등록하는 경우에는 신규 리소스를 서버에서 만들고**

신규 리소스를 식별할 수 있는 URI를 클라이언트한테 준다.


### 정리


- 클라이언트는 등록될 리소스의 URI를 모른다.
    - 그냥 서버에다가 회원 등록할 데이터를 서버로 보내면 서버에서 회원 저장하고 URI를 만들어준다. 그렇기 때문에 클라이언트는 등록될 리소스의 URI를 모른다.
- **서버가 새로 등록된 리소스 URI를 생성해준다.**
    - HTTP/1.1 201 Created

      Location : /members/1004

- 이런 형식을 컬렉션(Collection)이라고 한다.
    - 서버가 관리하는 리소스 디렉토리
    - 서버가 리소스의 URI를 생성하고 관리
    - 여기서 컬렉션은 /members

### API 설계 - PUT 기반 등록


파일 관리 시스템을 만든다고 가정

파일 등록할 때 PUT을 썼다.

클라이언트가 리소스 URI를 알고 있을 때 PUT을 사용한다.

### 정리


- 클라이언트가 리소스 URI를 알고 있어야 한다.
    - 파일 등록 /files/{filename} → PUT
    - PUT /files/img.png
- 클라이언트가 직접 리소스의 URI를 지정한다.
- 이런 걸 스토어(Store)라고 한다.
    - 클라이언트가 관리하는 리소스 저장소
    - 클라이언트가 리소스의 URI를 알고 관리한다.
    - 위에서 스토어는 /files


API를 설계할 때는 크게 2가지가 있다.

POST - Collection

PUT - Store

대부분은 POST 기반 컬렉션을 사용한다.

### HTML FORM 사용


**HTML FORM은 오로지 GET, POST만 지원한다.**


등록 폼- 등록을 같은 URL를 사용하는 것을 추천 → /members/new

수정 폼 - 수정도 마찬가지 → /members/{id}/edit

회원 삭제 같은 경우는 /delete 컨트롤 URI)를 사용할 수 밖에 없다.

- HTML FORM은 오로지 GET, POST만 가능
- 컨트롤 URI
    - GET, POST만 지원하기 때문에 이런 제약을 해결하기 위해 **동사**로 된 리소스 경로를 사용한다.
    - POST의 /new, /edit, /delete가 컨트롤 URI이다.
    - HTTP 메서드로 해결하기 애매한 경우 (HTTP API 포함)



### 참고하면 좋은 URI 설계 개념


- 문서 - 단일 개념( 파일 하나, 객체 인스턴스, 데이터베이스 row 등등)
- 컬렉션
    - 서버가 관리하는 리소스 디렉토리
    - 서버가 리소스의 URI를 생성하고 관리
- 스토어
    - 클라이언트가 관리하는 자원 저장소
    - 클라이언트가 리소스의 URI를 알고 관리
- 컨트롤러, 컨트롤 URI
    - 문서, 컬렉션, 스토어로 해결하기 어려운 추가 프로세스 실행할 때 사용
    - 동사를 직접 사용